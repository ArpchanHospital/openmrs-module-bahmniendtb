<?xml version="1.0" encoding="UTF-8"?>

<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
                   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                   xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
                  http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-2.0.xsd">

    <changeSet id="endtb-data-integrity-201608031000" author="Jaya, Deepak">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">SELECT count(*) from dataintegrity_rule where handler_classname='org.openmrs.module.bahmniendtb.dataintegrity.rules.NewDrugConsentSignedViolation'</sqlCheck>
        </preConditions>
        <comment>Add Drug Consent Rule to Data Integrity Rule</comment>
        <insert tableName="dataintegrity_rule">
            <column name="rule_name" value="New drug consent form not signed"/>
            <column name="rule_category" value="java"/>
            <column name="handler_config" value="java"/>
            <column name="handler_classname" value="org.openmrs.module.bahmniendtb.dataintegrity.rules.NewDrugConsentSignedViolation"/>
            <column name="uuid" valueComputed="uuid()"/>
        </insert>
    </changeSet>
    <changeSet id="endtb-data-integrity-201608031125" author="Jaya, Deepak">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">SELECT count(*) from dataintegrity_rule where handler_classname='org.openmrs.module.bahmniendtb.dataintegrity.rules.EndTBStudyConsentSignedViolation'</sqlCheck>
        </preConditions>
        <comment>Add EndTB Drug Consent Rule to Data Integrity Rule</comment>
        <insert tableName="dataintegrity_rule">
            <column name="rule_name" value="EndTB consent form not signed"/>
            <column name="rule_category" value="java"/>
            <column name="handler_config" value="java"/>
            <column name="handler_classname" value="org.openmrs.module.bahmniendtb.dataintegrity.rules.EndTBStudyConsentSignedViolation"/>
            <column name="uuid" valueComputed="uuid()"/>
        </insert>
    </changeSet>
    <changeSet id="endtb-data-integrity-201608111120" author="Vikash">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">SELECT count(*) from dataintegrity_rule where handler_classname='org.openmrs.module.bahmniendtb.dataintegrity.rules.MissingOutcomeViolation'</sqlCheck>
        </preConditions>
        <comment>Add Missing Outcome Rule to Data Integrity Rule</comment>
        <insert tableName="dataintegrity_rule">
            <column name="rule_name" value="Missing Outcome"/>
            <column name="rule_category" value="java"/>
            <column name="handler_config" value="java"/>
            <column name="handler_classname" value="org.openmrs.module.bahmniendtb.dataintegrity.rules.MissingOutcomeViolation"/>
            <column name="uuid" valueComputed="uuid()"/>
        </insert>
    </changeSet>

</databaseChangeLog>